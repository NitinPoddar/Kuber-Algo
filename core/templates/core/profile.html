{% extends "core/base.html" %}

{% block content %}
<section class="section">
    <div class="container">
        <h2 class="title is-4">Welcome, {{ name }}!</h2>

        {% if messages %}
            {% for message in messages %}
                <div class="notification is-{{ message.tags }}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}

        <h3 class="title is-5 has-text-grey-dark mt-4">Your Live Algorithms</h3>

        <div class="columns is-multiline">
            {% for box in boxes %}
            <div class="column is-one-quarter">
                <div class="box 
                    {% if box.status == 'registered' %}
                        has-background-warning-light
                    {% elif box.status == 'run' %}
                        has-background-success-light
                    {% else %}
                        has-background-light
                    {% endif %}
                " data-heading="{{ box.heading }}"
                   data-subheading1="{{ box.subheading1 }}"
                   data-subheading2="{{ box.subheading2 }}">

                    <p class="has-text-weight-semibold is-size-6">{{ box.heading }}</p>
                    <p class="is-size-7 has-text-grey">Profit: {{ box.subheading1 }}</p>
                    <p class="is-size-7 has-text-grey">Subscribers: {{ box.subheading2 }}</p>

                    <div class="mt-3">
                        {% if box.status == 'registered' %}
                            <button class="button is-small is-info" onclick="actionHandler({{ box.id }}, 'play')">
                                <span class="icon"><i class="fas fa-play"></i></span>
                                <span>Run</span>
                            </button>
                        {% elif box.status == 'run' %}
                            <button class="button is-small is-warning" onclick="actionHandler({{ box.id }}, 'pause')">
                                <span class="icon"><i class="fas fa-pause"></i></span>
                                <span>Pause</span>
                            </button>
                        {% else %}
                            <button class="button is-small is-primary" onclick="openRegistrationForm(this)">
                                <span class="icon"><i class="fas fa-plus-circle"></i></span>
                                <span>Register</span>
                            </button>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="column is-12">
                <div class="notification is-light">
                    You have not registered any algorithms yet.
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Placeholder for modal or forms like algo registration/run -->
{% endblock %}
